# FaceRoster 関係性作成機能 UXデザイン仕様書

## 概要

FaceRosterアプリケーションにおける人物間の関係性（コネクション）作成機能のUXを、より直感的で柔軟なものに改善するための設計仕様書です。双方向の関係（友人、同僚）と単方向の関係（親子、上司部下）の両方を、明確かつ使いやすい形で扱えるようにします。

## 現状の課題分析

現在のドラッグ&ドロップ方式には以下の課題があります：

- **関係の方向性が暗黙的**：親→子、上司→部下などの方向性が不明確
- **関係タイプの区別が困難**：双方向（友人、同僚）と単方向（親子）の区別が不明確
- **モバイルでの操作性**：ドラッグ&ドロップがタッチデバイスで困難
- **既存関係の可視性**：誰と誰が既に関係を持っているかが見えにくい

## 提案する新しいUXデザイン

### 1. ハイブリッド接続方式

ドラッグ&ドロップを基本としつつ、関係性の性質に応じた視覚的フィードバックを提供します。

#### ドラッグ中の視覚的ガイド

```
【ドラッグ開始時】
- ドラッグ元のカードから矢印が伸びる
- 矢印の先端がマウスカーソルを追従
- ドラッグ元カードが軽くハイライト

【ホバー時】
- ドロップ可能なカードが青くハイライト
- 関係性のプレビューが表示される
  例：「田中太郎 → 山田花子」
- 既存の関係がある場合は警告アイコン表示
```

### 2. スマートな関係性提案システム

ドロップ時のダイアログを、関係性のタイプに応じて知的に提案します。

#### 関係性作成ダイアログ（改善版）

```
┌─────────────────────────────────────────────┐
│  関係性を作成                               │
│                                             │
│  👤 田中太郎 ←→ 👤 山田花子                │
│                                             │
│ ─────────────────────────────────────────── │
│                                             │
│ 📌 よくある関係性                           │
│                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐     │
│ │ 👥      │ │ 👫      │ │ 🤝      │     │
│ │  同僚   │ │  友人   │ │ 知人    │     │
│ └─────────┘ └─────────┘ └─────────┘     │
│                                             │
│ ➡️ 階層的な関係性                           │
│ （田中太郎 → 山田花子 として）              │
│                                             │
│ ┌─────────┐ ┌─────────┐ ┌─────────┐     │
│ │ 👨‍👦      │ │ 👔      │ │ 🎓      │     │
│ │親(父/母)│ │  上司   │ │メンター │     │
│ └─────────┘ └─────────┘ └─────────┘     │
│                                             │
│ 💑 特別な関係                               │
│                                             │
│ ┌─────────┐ ┌─────────┐                 │
│ │ 💏      │ │ 💍      │                 │
│ │配偶者   │ │パートナー│                 │
│ └─────────┘ └─────────┘                 │
│                                             │
│ ─────────────────────────────────────────── │
│                                             │
│ 🏷️ カスタム関係                            │
│ ┌─────────────────────────────────────┐   │
│ │ その他の関係を入力...                │   │
│ └─────────────────────────────────────┘   │
│                                             │
│ 📝 詳細情報（任意）                         │
│ ┌─────────────────────────────────────┐   │
│ │ 関係の理由：                        │   │
│ │ 例：2020年のプロジェクトで知り合った│   │
│ └─────────────────────────────────────┘   │
│                                             │
│ 💪 関係の強さ：[●●●○○] 3/5               │
│                                             │
│ ┌─────────────────────────────────────┐   │
│ │ メモ：                              │   │
│ │                                     │   │
│ └─────────────────────────────────────┘   │
│                                             │
│         [キャンセル]  [保存]                │
└─────────────────────────────────────────────┘
```

### 3. 関係性の可視化改善

#### 人物カードのデザイン改善

人物カードに既存の関係性を示すバッジを表示します。

```
┌─────────────────────┐
│   👤 田中太郎       │
│                     │
│   🏢 Acme Corp      │
│   🎂 1985/03/15     │
│                     │
│ ┌───┬───┬───┬───┐ │
│ │👥2│👨‍👦1│👔1│💑1│ │
│ └───┴───┴───┴───┘ │
└─────────────────────┘

バッジの意味：
👥2 - 双方向の関係が2つ（友人、同僚など）
👨‍👦1 - 親子関係が1つ
👔1 - 階層関係が1つ（上司部下など）
💑1 - 特別な関係が1つ（配偶者など）
```

#### ホバー時の関係性プレビュー

カードにホバーすると、その人物の関係性を簡潔に表示：

```
┌─────────────────────────┐
│ 田中太郎の関係性        │
├─────────────────────────┤
│ 👥 山田花子（同僚）     │
│ 👥 佐藤次郎（友人）     │
│ 👨‍👦 田中小太郎（息子）   │
│ 👔 鈴木部長（上司）     │
│ 💑 田中良子（配偶者）   │
│                         │
│ [すべて表示...]         │
└─────────────────────────┘
```

### 4. コンテキストメニューによる代替操作

モバイルデバイスやアクセシビリティを考慮した操作方法を提供します。

#### 長押し/右クリックメニュー

```
┌──────────────────────┐
│ 田中太郎             │
├──────────────────────┤
│ ⚡ クイック接続      │
│ 🔗 関係を作成        │
│ 👁️ 関係を表示        │
│ ✏️ 情報を編集        │
│ 🗑️ 削除             │
└──────────────────────┘
```

#### クイック接続モード

```
【Step 1: 対象を選択】
"クイック接続"選択後、接続したい人物をタップ

【Step 2: 関係タイプを選択】
ポップアップから関係タイプを選択して完了
```

### 5. 関係性作成の新フロー

#### フロー1: ドラッグ&ドロップ（デスクトップ向け）

1. **ドラッグ開始**：視覚的フィードバック表示
2. **ドロップ**：関係性作成ダイアログ表示
3. **関係選択**：タイプ別に整理された選択肢から選択
4. **詳細入力**：必要に応じて詳細情報を入力
5. **保存**：Firestoreに保存

#### フロー2: タップ操作（モバイル向け）

1. **選択モード起動**：「関係を作成」ボタンをタップ
2. **2人を選択**：関係を作りたい2人をタップで選択
3. **関係選択**：簡易ダイアログから関係タイプを選択
4. **完了**：即座に保存（詳細は後から編集可能）

### 6. 視覚的な関係性マップビュー

人物一覧に加えて、関係性を俯瞰できるネットワークビューを提供します。

#### ネットワークビューの特徴

```
【表示モード切り替え】
┌─────┬─────┬─────┐
│ 📋  │ 🕸️  │ 🌳  │
│一覧 │ﾈｯﾄ │階層 │
└─────┴─────┴─────┘

【ネットワークビュー例】
        👤 自分
       /   |   \
    👥    👔    👨‍👩‍👦
   同僚  上司   家族
    |     |      |
   田中  鈴木   妻・子

【フィルター機能】
□ 友人関係
□ 仕事関係
□ 家族関係
□ その他
```

### 7. スマートな重複防止とエラーハンドリング

#### 既存関係の検出と処理

```
┌─────────────────────────────────────┐
│ ⚠️ 既存の関係があります             │
│                                     │
│ 現在の関係：                        │
│ • 田中太郎 → 山田花子（上司）       │
│                                     │
│ どうしますか？                      │
│                                     │
│ ○ 新しい関係を追加する             │
│   （複数の関係を持つことができます）│
│                                     │
│ ○ 既存の関係を更新する             │
│   （現在の関係を置き換えます）      │
│                                     │
│ ○ キャンセル                       │
│                                     │
│        [戻る]  [続ける]             │
└─────────────────────────────────────┘
```

#### 循環関係の警告

```
┌─────────────────────────────────────┐
│ ⚠️ 循環関係の可能性                 │
│                                     │
│ 山田さんは既に田中さんの上司です。  │
│ 田中さんを山田さんの上司に設定する  │
│ と、循環関係が発生します。          │
│                                     │
│ □ それでも続ける                   │
│                                     │
│        [キャンセル]  [OK]           │
└─────────────────────────────────────┘
```

## 実装の優先順位

### Phase 1: 基本機能の改善（1-2週間）
- 関係タイプの分類とデータモデル更新
- 改善されたダイアログUIの実装
- 基本的な視覚フィードバック

### Phase 2: 視覚的改善（1-2週間）
- 人物カードへのバッジ表示
- ドラッグ&ドロップの視覚的フィードバック
- ホバー時の関係性プレビュー

### Phase 3: モバイル対応（1週間）
- タップベースの関係作成フロー
- コンテキストメニューの実装
- レスポンシブデザインの調整

### Phase 4: 高度な機能（2-3週間）
- ネットワークビューの実装
- 高度なフィルタリング機能
- 関係性の分析機能

## 技術的考慮事項

### パフォーマンス
- 大量の関係性データを扱う際の最適化
- 遅延読み込みとページネーション
- キャッシング戦略

### アクセシビリティ
- キーボード操作のサポート
- スクリーンリーダー対応
- 高コントラストモード

### 国際化
- 関係タイプの多言語対応
- 文化的な違いへの配慮（家族構成など）

## まとめ

この新しいUXデザインにより、FaceRosterは複雑な人間関係を直感的かつ正確に記録できるツールとなります。ドラッグ&ドロップの使いやすさを保ちながら、関係の方向性や種類を明確に表現でき、モバイルデバイスでも快適に使用できるようになります。